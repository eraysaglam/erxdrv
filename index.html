<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ErX Driver</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    html, body { margin: 0; padding: 0; height: 100%; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
    #appStart { height: 100vh; display: flex; justify-content: center; align-items: center; flex-direction: column; }
    .start-button { background-color: #007bff; color: white; padding: 16px 30px; margin: 10px; border: none; border-radius: 30px; font-size: 18px; cursor: pointer; }
    .start-button small { display: block; font-size: 14px; color: #e0e0e0; margin-top: 5px; }
    #mapWrapper { display: none; }
    #map { position: absolute; height: 100vh; width: 100%; z-index: 0; }
    .sidebar { position: fixed; top: 0; left: 0; bottom: 0; width: 220px; background-color: #111; color: white; padding: 20px; z-index: 1000; }
    .sidebar ul { list-style: none; padding: 0; }
    .sidebar ul li { padding: 10px 0; border-bottom: 1px solid #444; cursor: pointer; }
    .sidebar ul li:hover { background-color: #222; }
    .earnings { position: fixed; top: 20px; right: 20px; background-color: #000; color: #0f0; font-size: 18px; padding: 10px 20px; border-radius: 10px; z-index: 1001; }
    .status-button { position: fixed; bottom: 30px; right: 30px; z-index: 2000; background-color: #dc3545; color: white; padding: 12px 20px; border: none; border-radius: 25px; font-size: 16px; cursor: pointer; }

    .offer-box {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 310px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      padding: 20px;
      z-index: 9999;
      font-size: 14px;
    }
    .offer-header {
      font-weight: bold;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
    }
    .offer-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
    }
    .offer-buttons button {
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      flex: 1;
      margin: 0 5px;
      cursor: pointer;
    }
    .accept { background-color: #28a745; color: white; }
    .reject { background-color: #dc3545; color: white; }
  </style>
</head>
<body>

<div id="appStart">
  <button class="start-button" onclick="startAsDriver()">
    Ben Bir S√ºr√ºc√ºy√ºm
    <small>I'm a Driver</small>
  </button>
  <button class="start-button" onclick="alert('Yolcu ekranƒ± yakƒ±nda aktif olacak!')">
    Ben Bir Yolcuyum
    <small>I'm a Rider</small>
  </button>
</div>

<div id="mapWrapper">
  <div class="sidebar">
    <h2>ErX Driver</h2>
    <ul>
      <li onclick="showPanel('üì• Gelen Kutusu', '<ul><li>Yeni mesajƒ±nƒ±z var üì©</li><li>√ñdeme makbuzunuz hazƒ±r üßæ</li></ul>')">üì• Gelen Kutusu</li>
      <li onclick="showPanel('üí° Tavsiyeler', '<p>Daha fazla kazan√ß i√ßin yoƒüun b√∂lgeleri tercih edin!</p>')">üí° Tavsiyeler</li>
      <li onclick="showPanel('üéÅ Fƒ±rsatlar', '<p>Bug√ºn ekstra bonus fƒ±rsatƒ± yakalayƒ±n!</p>')">üéÅ Fƒ±rsatlar</li>
      <li onclick="showPanel('üìà Kazan√ßlar', '<p>Son 7 g√ºn kazancƒ±nƒ±z: $550.00</p>')">üìà Kazan√ßlar</li>
      <li onclick="showPanel('üí≥ C√ºzdan', '<p>Bakiyeniz: $120.75</p>')">üí≥ C√ºzdan</li>
      <li onclick="showPanel('üë§ Hesap', '<p>Profil ayarlarƒ±nƒ± buradan yapabilirsiniz.</p>')">üë§ Hesap</li>
    </ul>
  </div>
  <div class="earnings" id="earningsBox">$89.93</div>
  <div id="map"></div>
  <button class="status-button" id="statusBtn" onclick="toggleStatus()">Offline</button>
</div>

<script>
let isOnline = false;
let vehicles = [];
let map;
let offerInterval;

function startAsDriver() {
  document.getElementById("appStart").style.display = "none";
  document.getElementById("mapWrapper").style.display = "block";

  map = L.map("map").setView([28.3772, -81.5707], 13);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

  const carIcon = L.icon({
    iconUrl: "https://cdn-icons-png.flaticon.com/512/744/744465.png",
    iconSize: [40, 40]
  });

  for (let i = 0; i < 50; i++) {
    let lat = 28.3772 + (Math.random() - 0.5) * 0.01;
    let lng = -81.5707 + (Math.random() - 0.5) * 0.01;
    const marker = L.marker([lat, lng], { icon: carIcon }).addTo(map);
    vehicles.push({ lat, lng, marker });
  }

  setInterval(() => {
    vehicles.forEach(v => {
      v.lat += (Math.random() - 0.5) * 0.001;
      v.lng += (Math.random() - 0.5) * 0.001;
      v.marker.setLatLng([v.lat, v.lng]);
    });
  }, 1000);
}

function toggleStatus() {
  isOnline = !isOnline;
  const btn = document.getElementById("statusBtn");
  btn.innerText = isOnline ? "Online" : "Offline";
  btn.style.backgroundColor = isOnline ? "#28a745" : "#dc3545";

  if (isOnline) {
    offerInterval = setInterval(showOffer, 20000);
    alert("≈ûu anda ONLINE durumdasƒ±nƒ±z.");
  } else {
    clearInterval(offerInterval);
    alert("≈ûu anda OFFLINE durumdasƒ±nƒ±z.");
  }
}

function showPanel(title, content){
  const panel = document.createElement('div');
  panel.style.position = 'fixed';
  panel.style.top = '50px';
  panel.style.right = '30px';
  panel.style.width = '300px';
  panel.style.background = 'white';
  panel.style.border = '1px solid #ccc';
  panel.style.padding = '20px';
  panel.style.borderRadius = '10px';
  panel.style.zIndex = '9999';
  panel.style.boxShadow = '0 0 10px rgba(0,0,0,0.2)';
  panel.innerHTML = `
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <strong>${title}</strong>
      <button onclick="this.parentElement.parentElement.remove()" 
        style="background:red; color:white; border:none; border-radius:50%; width:25px; height:25px; cursor:pointer;">√ó</button>
    </div>
    <div style="margin-top:10px;">${content}</div>
  `;
  document.body.appendChild(panel);
}

function getRandomVehicleClass() {
  const classes = ["XL", "BLACK SUV", "ErX Standart", "Comfort", "Business"];
  return classes[Math.floor(Math.random() * classes.length)];
}

function showOffer() {
  const pickupMiles = (Math.random() * 3 + 1).toFixed(1);
  const dropoffMiles = (Math.random() * 10 + 2).toFixed(1);
  const eta = Math.floor(Math.random() * 8 + 3);
  const price = (Math.random() * 20 + 10).toFixed(2);
  const klass = getRandomVehicleClass();

  const offer = document.createElement("div");
  offer.className = "offer-box";
  offer.innerHTML = `
    <div class="offer-header">
      <span>${klass}</span>
      <span><strong>$${price}</strong></span>
    </div>
    <p><strong>üöó Pickup:</strong> ${pickupMiles} mil - ${eta} dk uzaklƒ±kta</p>
    <p><strong>üìç Dropoff:</strong> ${dropoffMiles} mil yol</p>
    <div class="offer-buttons">
      <button class="accept" onclick="acceptOffer(this.parentElement.parentElement, ${price})">Kabul Et</button>
      <button class="reject" onclick="rejectOffer(this.parentElement.parentElement)">Reddet</button>
    </div>
  `;
  document.body.appendChild(offer);
}

function acceptOffer(offerEl, price) {
  offerEl.remove();
  let earningsBox = document.getElementById("earningsBox");
  let current = parseFloat(earningsBox.innerText.replace('$', ''));
  earningsBox.innerText = `$${(current + parseFloat(price)).toFixed(2)}`;
  alert("Teklif kabul edildi!");
}

function rejectOffer(offerEl) {
  offerEl.remove();
  alert("Teklif reddedildi.");
}
</script>

</body>
</html>
