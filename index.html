<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ErX Driver</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      height: 100%;
      overflow: hidden;
      background: white;
    }
    #appStart {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }
    .start-button {
      background-color: #007bff;
      color: white;
      padding: 16px 30px;
      margin: 10px;
      border: none;
      border-radius: 30px;
      font-size: 18px;
      cursor: pointer;
    }
    #mapWrapper {
      display: none;
    }
    #map {
      position: absolute;
      height: 100vh;
      width: 100%;
      z-index: 0;
    }
    .sidebar {
      position: fixed;
      top: 0;
      left: 0;
      bottom: 0;
      width: 220px;
      background-color: #111;
      color: white;
      padding: 20px;
      z-index: 1000;
    }
    .sidebar ul {
      list-style: none;
      padding: 0;
    }
    .sidebar ul li {
      padding: 10px 0;
      border-bottom: 1px solid #444;
      cursor: pointer;
    }
    .sidebar ul li:hover {
      background-color: #222;
    }
    .earnings {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #000;
      color: #0f0;
      font-size: 18px;
      padding: 10px 20px;
      border-radius: 10px;
      z-index: 1001;
    }
    .status-button {
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 2000;
      background-color: #28a745;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="appStart">
  <button class="start-button" onclick="startAsDriver()">Ben Bir Driver'ım</button>
  <button class="start-button" onclick="alert('Yolcu ekranı yakında aktif olacak!')">Ben Bir Yolcuyum</button>
</div>

<div id="mapWrapper">
  <div class="sidebar">
    <h2>ErX Driver</h2>
    <ul>
      <li onclick="alert('Gelen Kutusu')">📥 Gelen Kutusu</li>
      <li onclick="alert('Tavsiyeler')">💡 Tavsiyeler</li>
      <li onclick="alert('Fırsatlar')">🎁 Fırsatlar</li>
      <li onclick="alert('Kazançlar')">📈 Kazançlar</li>
      <li onclick="alert('Cüzdan')">💳 Cüzdan</li>
      <li onclick="alert('Hesap')">👤 Hesap</li>
      <hr/>
      <li onclick="alert('Eğitim Merkezi')">📚 Eğitim Merkezi</li>
      <li onclick="alert('Yardım Merkezi')">🆘 Yardım Merkezi</li>
      <li onclick="alert('Canlı Destek')">💬 Canlı Destek</li>
    </ul>
  </div>
  <div class="earnings">$89.93</div>
  <div id="map"></div>
  <button class="status-button" id="toggleStatusButton" onclick="toggleOnlineStatus()">GO ONLINE</button>
</div>

<script>
  let vehicles = [];
  let isOnline = false;
  let offerInterval;

  function startAsDriver() {
    document.getElementById("appStart").style.display = "none";
    document.getElementById("mapWrapper").style.display = "block";

    const map = L.map("map").setView([28.3772, -81.5707], 13);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    const carIcon = L.icon({
      iconUrl: 'https://cdn-icons-png.flaticon.com/512/744/744465.png',
      iconSize: [40, 40],
      iconAnchor: [20, 20]
    });

    const baseLat = 28.3772;
    const baseLng = -81.5707;

    for (let i = 0; i < 70; i++) {
      let lat = baseLat + (Math.random() - 0.5) * 0.01;
      let lng = baseLng + (Math.random() - 0.5) * 0.01;
      const marker = L.marker([lat, lng], { icon: carIcon }).addTo(map);
      vehicles.push({ lat, lng, marker });
    }

    setInterval(() => {
      vehicles.forEach(vehicle => {
        vehicle.lat += (Math.random() - 0.5) * 0.001;
        vehicle.lng += (Math.random() - 0.5) * 0.001;
        vehicle.marker.setLatLng([vehicle.lat, vehicle.lng]);
      });
    }, 1200);
  }

  function toggleOnlineStatus() {
    const btn = document.getElementById('toggleStatusButton');

    if (!isOnline) {
      isOnline = true;
      btn.innerText = 'GO OFFLINE';
      btn.style.backgroundColor = '#dc3545';
      alert('Şu anda ONLINE durumdasınız.');

      offerInterval = setInterval(() => {
        showIncomingOffer();
      }, 20000); // 20 saniyede bir teklif
    } else {
      isOnline = false;
      btn.innerText = 'GO ONLINE';
      btn.style.backgroundColor = '#28a745';
      alert('Şu anda OFFLINE durumdasınız.');

      clearInterval(offerInterval);
    }
  }

  function showIncomingOffer() {
    const offerBox = document.createElement('div');
    offerBox.style.position = 'fixed';
    offerBox.style.bottom = '30px';
    offerBox.style.right = '30px';
    offerBox.style.backgroundColor = 'white';
    offerBox.style.border = '2px solid #000';
    offerBox.style.padding = '20px';
    offerBox.style.borderRadius = '10px';
    offerBox.style.zIndex = '9999';
    offerBox.innerHTML = `
      <h3>Yeni Teklif 🚗</h3>
      <p>Mesafe: ${(Math.random() * 5 + 1).toFixed(1)} km</p>
      <p>Ücret: $${(Math.random() * 15 + 5).toFixed(2)}</p>
      <button style="margin-right:10px; padding:8px 16px;" onclick="acceptOffer(this.parentElement)">Kabul Et</button>
      <button style="padding:8px 16px;" onclick="rejectOffer(this.parentElement)">Reddet</button>
    `;
    document.body.appendChild(offerBox);
  }

  function acceptOffer(offerBox) {
    alert('Teklif kabul edildi! 🚀');
    offerBox.remove();
  }

  function rejectOffer(offerBox) {
    alert('Teklif reddedildi. ❌');
    offerBox.remove();
  }
</script>

</body>
</html>
